<html>

    <body> 
        {% include 'AgriTrust/header.html' with user=user %}

        <div>
            <div>        
                <h3> {{employee.fullname}} </h3>
        
                <p> Personal Information </p>

                <form id = "update-profile-form">

                    <input type="hidden" id="id" name="id" value="{{employee.id}}">

                    <div>
                        <label class="label" for="email">Email:</label>
                        <input class="input" id="email" name="email" value = "{{employee.email}}" required>
                    </div>
                    <div>
                        <label class="label" for="username">Username:</label>
                        <input class="input" id="username" name="username" value="{{employee.username}}" required">
                    </div>
                    <div>
                        <label class="label" for="first_name">First Name:</label>
                        <input class="input" id="first_name" name="first_name" value="{{employee.first_name}}" required>
                    </div>
                    <div>
                        <label for="middle_name">Middle Name:</label>
                        <input type="text" id="middle_name" name="middle_name" value="{{employee.middle_name}}" required">
                    </div>
                    <div >
                        <label for="last_name">Last Name:</label>
                        <input type="text" id="last_name" name="last_name" value="{{employee.last_name}}" required">
                    </div>
                    
                    <button  onclick="handleUpdateProfileClick(event)"> Update Profile </button>
                </form>
            </div>

            <div> 
                <p> Change Password </p>

                <form id = "change-password-form">

                    <input type="hidden" id="id" name="id" value="{{employee.id}}">
  
                    <div>
                        <label class="label" for="old_password"> Old Password:</label>
                        <input class="input" id="old_password" name="old_password" required>
                    </div>

                    <div>
                        <label class="label" for="new_password">New Password:</label>
                        <input class="input" id="new_password" name="new_password" required>
                    </div>

                    <button onclick="handleChangePasswordClick(event)"> Change Password </button>
                
                </form>                
            </div>
        </div>

    </body>

    <script>
        async function handleUpdateProfileClick(event) {
            event.preventDefault();
            form = document.getElementById("update-profile-form");
            formData = new FormData(form);

            const response = await fetch("{% url 'server_update_employee' %}", {
                method: "POST",
                body: formData,
                headers : {
                    'X-CSRFToken': "{{csrf_token}}",
                    "contrent-type": "application/json"
                }
            })


        }

        async function handleChangePasswordClick (params) {
            event.preventDefault();
            form = document.getElementById("change-password-form");
            formData = new FormData(form);

            const response = await fetch("{% url 'server_update_employee_password' %}", {
                method: "POST",
                body: formData,
                headers : {
                    'X-CSRFToken': "{{csrf_token}}",
                    "contrent-type": "application/json"
                }
            })
        }
    </script> 

</html>